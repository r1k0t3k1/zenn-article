---
title: "Nmapに祝われるクリスマス"
emoji: "📝"
type: "tech"
topics: ["security"]
published: true
---

# Xmasスキャン
Nmapには色々なスキャンタイプを実行する機能がありますが、その一つに**Xmasスキャン**というスキャンタイプがあります。
FIN,URG,PSHの三種類のフラグが立ったパケットを送信します。このフラグが同時に立っている状態は矛盾している状態のため、このパケットが処理されることはありませんが、対象ポート上でサービスが動いていた場合はパケットは破棄され、サービスが動いていない場合はRSTパケットが返されることを利用してポートの状態を判別するスキャンタイプです。
当初はURG,ACK,PSH,RST,SYN,FINの全てのフラグを立てていたそうです。このフラグが全て立っている様子がクリスマスツリーが飾り付けられているように見えたことが名前の由来。（私にはそうは見えませんでした。）ですが現在は上記の三種類が立っていれば十分ということでクリスマスツリーらしさは半減してます。

# Nmapのバージョン情報をクリスマス(12/25)に表示すると…？
Nmapがクリスマスを祝ってくれます。
![メリクリ](https://github.com/riko-teki/pictures/blob/main/Screenshot_2021-12-25_12_21_58.png?raw=true)

# 終わりに
クリスマスを一緒に祝う人がいない場合は**nmap -v**で素敵なクリスマスにしましょう。